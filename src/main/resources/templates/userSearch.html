<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>„É¶„Éº„Ç∂„ÉºÊ§úÁ¥¢ | Atlas</title>

	<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
	<link rel="stylesheet" th:href="@{/css/reset.css}" />
	<link rel="stylesheet" th:href="@{/css/header.css}" />
	<link rel="stylesheet" th:href="@{/css/sidebar.css}" />
	<link rel="stylesheet" th:href="@{/css/userSearch.css}" href="/css/userSearch.css" />
</head>
<body>
	<header th:replace="~{fragments/header :: header}"></header>

	<main class="container">
		<section class="content">
			<div class="left-wrapper">
				<section class="search-bar">
				    <div class="search-bar-inner">
				        <form th:action="@{/userSearch}" method="get" class="search-form" style="display:flex; gap:5px;">
				            <input type="text" name="keyword" class="search-input" placeholder="„É¶„Éº„Ç∂„ÉºÂêç" th:value="${keyword}">
				            <button class="search-button" type="submit" aria-label="Ê§úÁ¥¢">
				                <img th:src="@{/images/search.png}" src="/images/search.png" alt="Ê§úÁ¥¢" />
				            </button>
				        </form>

				        <!-- üîΩ Áõ¥Ââç„ÅÆÊ§úÁ¥¢„ÉØ„Éº„Éâ„ÇíË°®Á§∫ -->
				        <span th:if="${keyword != null and !#strings.isEmpty(keyword)}" class="search-result-keyword">
							Ê§úÁ¥¢„ÉØ„Éº„ÉâÔºö
				            <span th:text="${keyword}"></span>
				        </span>
				    </div>
				</section>

				<div class="list-wrap">
					<ul class="user-list">
						<li th:if="${#lists.isEmpty(userList)}" class="empty">Ë©≤ÂΩì„É¶„Éº„Ç∂„Éº„Åå„ÅÑ„Åæ„Åõ„Çì„ÄÇ</li>

						<li class="user-item" th:each="u : ${userList}">
							<div class="user">
								<div class="avatar-wrapper">
									<a th:href="@{/users/{id}(id=${u.id})}">
										<img class="avatar-img"
											th:if="${u.iconImage != null and #strings.startsWith(u.iconImage, 'http')}"
											th:src="${u.iconImage}" alt="„É¶„Éº„Ç∂„Éº„Ç¢„Ç§„Ç≥„É≥" />

										<img class="avatar-img"
											th:if="${u.iconImage != null and !#strings.startsWith(u.iconImage, 'http')}"
											th:src="@{'images/' + ${u.iconImage}}" alt="„É¶„Éº„Ç∂„Éº„Ç¢„Ç§„Ç≥„É≥" />

										<div class="avatar-circle"
											th:if="${u.iconImage == null or #strings.isEmpty(u.iconImage)}"
											th:classappend="' c' + (${u.id} % 6)">
											<span th:text="${#strings.substring(u.name,0,1).toUpperCase()}">A</span>
										</div>
									</a>
								</div>
								<div class="user-name">
									<a th:href="@{/otherAccountPage(id=${u.id})}" th:text="${u.name}">username</a>
								</div>
							</div>

							<div class="actions">
								<form th:if="${followingIds.contains(u.id)}" th:action="@{/unfollow}" method="post">
									<input type="hidden" name="targetId" th:value="${u.id}">
									<input type="hidden" name="keyword" th:value="${keyword}">
									<input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
									<button type="submit" class="btn btn-unfollow">„Éï„Ç©„É≠„ÉºËß£Èô§</button>
								</form>

								<form th:if="${!followingIds.contains(u.id)}" th:action="@{/follow}" method="post">
									<input type="hidden" name="targetId" th:value="${u.id}">
									<input type="hidden" name="keyword" th:value="${keyword}">
									<input type="hidden" th:if="${_csrf != null}" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
									<button type="submit" class="btn btn-follow">„Éï„Ç©„É≠„Éº„Åô„Çã</button>
								</form>
							</div>
						</li>
					</ul>
				</div>
			</div>

			<aside th:replace="~{fragments/sidebar :: sidebar}"></aside>
		</section>
	</main>

	<script th:src="@{/js/header.js}"></script>
</body>
</html>