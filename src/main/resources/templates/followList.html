<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>フォロー一覧 | Atlas</title>

  <link rel="stylesheet" th:href="@{/css/reset.css}" />
  <link rel="stylesheet" th:href="@{/css/header.css}" />
  <link rel="stylesheet" th:href="@{/css/sidebar.css}" />
  <link rel="stylesheet" th:href="@{/css/followList.css}" />
  <!-- Google Icons（元に戻す） -->
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>
<body>
<header th:replace="~{fragments/header :: header}"></header>

<div class="followList-container">
  <div class="followList-wrapper">

		<div class="strip">
		  <h1 class="strip-title">フォローリスト</h1>

		  <div class="icon-list">
			<a th:each="u : ${followings}" th:href="@{/users/{id}(id=${u.id})}">
			  <th:block th:with="pimg=${u.iconImage},
			                     hasVal=${!#strings.isEmpty(pimg)},
			                     isUser=${hasVal} ? ${#strings.startsWith(pimg,'/user-icons/')} : false,
			                     isImgAbs=${hasVal} ? ${#strings.startsWith(pimg,'/images/')} : false,
			                     iconPath=${!hasVal ? '/images/icon1.png' : (isUser || isImgAbs ? pimg : '/images/' + pimg)}">
			    <img th:src="${iconPath}" class="icon-img" alt="アイコン" />
			  </th:block>
			</a>
		  </div>
		</div>

	<ul>
		<li th:each="card : ${userCards}" class="post-item">
		  <div class="post-main">
		    <!-- アイコン表示 -->
		    <th:block th:with="pimg=${card.user.iconImage},
		                hasVal=${!#strings.isEmpty(pimg)},
		                isUser=${hasVal} ? ${#strings.startsWith(pimg,'/user-icons/')} : false,
		                isImgAbs=${hasVal} ? ${#strings.startsWith(pimg,'/images/')} : false,
		                iconPath=${!hasVal ? '/images/icon1.png' : (isUser || isImgAbs ? pimg : '/images/' + pimg)}">
		      <a th:href="@{/users/{id}(id=${card.user.id})}">
		        <img th:src="${iconPath}" alt="アイコン" class="post-icon" />
		      </a>
		    </th:block>

		    <div class="post-head">
		      <p>
		        <a th:href="@{/users/{id}(id=${card.user.id})}"
		           th:text="${card.user.name}">ユーザー名</a>
		      </p>
		      <p class="post-text"
		         th:if="${card.latestPost != null}"
		         th:text="${card.latestPost.post}">投稿内容</p>
		      <p th:if="${card.latestPost == null}">投稿なし</p>
		    </div>
		  </div>

		  <div class="post-right">
		    <p class="post-time"
		       th:if="${card.latestPost != null}"
		       th:text="${#temporals.format(card.latestPost.createdAt, 'yyyy-MM-dd HH:mm')}">日時</p>
		  </div>
		</li>
	</ul>

  </div>

  <!-- 右サマリー枠を使っているCSSならここに aside を置く -->
  <aside class="follow-summary">
    <aside th:replace="~{fragments/sidebar :: sidebar}"></aside>
  </aside>
</div>

<script th:src="@{/js/header.js}"></script>
</body>
</html>